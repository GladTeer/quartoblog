<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.4.555" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Suyog Chandramouli" />
<meta name="dcterms.date" content="2025-02-26" />

<title>quartoblog – Lab 4 - Multinomial Regression - Questions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css" />
</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="/index.html">
    <span class="navbar-title">quartoblog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
  aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"
  onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i 
  class="bi bi-github" 
  role="img" 
>
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i 
  class="bi bi-twitter" 
  role="img" 
>
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div id="quarto-toc-target"></div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default toc-left">
  <div class="quarto-title-banner">
    <div class="quarto-title column-body">
      <h1 class="title">Lab 4 - Multinomial Regression - Questions</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Suyog Chandramouli </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 26, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data" id="toc-data">Data</a></li>
  <li><a href="#lab" id="toc-lab">Lab</a>
  <ul>
  <li><a href="#lrt" id="toc-lrt">LRT</a></li>
  <li><a href="#marginal-effects-political-group---emmeans" id="toc-marginal-effects-political-group---emmeans">Marginal Effects Political Group - Emmeans</a></li>
  <li><a href="#marginal-effects-of-education---emmeans" id="toc-marginal-effects-of-education---emmeans">Marginal Effects of Education - Emmeans</a></li>
  <li><a href="#write-up" id="toc-write-up">Write-up</a>
  <ul>
  <li><a href="#differences-between-political-groups-and-voting-behavior---emmeans" id="toc-differences-between-political-groups-and-voting-behavior---emmeans">Differences between political groups and voting behavior - Emmeans</a></li>
  <li><a href="#differences-between-education-level-and-voting-behavior---emmeans" id="toc-differences-between-education-level-and-voting-behavior---emmeans">Differences between education level and voting behavior - Emmeans</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
<p>Lab Goal: Predict voting frequency using demographic variables Data source: FiveThirtyEight “Why Many Americans Don’t Vote” survey Method: Multinomial logistic regression</p>
<section id="data" class="level2">
<h2>Data</h2>
<p>The data for this assignment comes from an online Ipsos survey that was conducted for the FiveThirtyEight article <a href="https://projects.fivethirtyeight.com/non-voters-poll-2020-election/">“Why Many Americans Don’t Vote”</a>. You can read more about the survey design and respondents in the README of the <a href="https://github.com/fivethirtyeight/data/tree/master/non-voters">GitHub repo</a> for the data.</p>
<p>Respondents were asked a variety of questions about their political beliefs, thoughts on multiple issues, and voting behavior. We will focus on using the demographic variables and someone’s party identification to understand whether a person is a probable voter.</p>
<p>The variables we’ll focus on were (definitions from the codebook in data set GitHub repo):</p>
<ul>
<li><p><code>ppage</code>: Age of respondent</p></li>
<li><p><code>educ</code>: Highest educational attainment category.<br />
</p></li>
<li><p><code>race</code>: Race of respondent, census categories. Note: all categories except Hispanic were non-Hispanic.</p></li>
<li><p><code>gender</code>: Gender of respondent</p></li>
<li><p><code>income_cat</code>: Household income category of respondent</p></li>
<li><p><code>Q30</code>: Response to the question “Generally speaking, do you think of yourself as a…”</p>
<ul>
<li>1: Republican</li>
<li>2: Democrat</li>
<li>3: Independent</li>
<li>4: Another party, please specify</li>
<li>5: No preference</li>
<li>-1: No response</li>
</ul></li>
<li><p><code>voter_category</code>: past voting behavior:</p>
<ul>
<li><strong>always</strong>: respondent voted in all or all-but-one of the elections they were eligible in</li>
<li><strong>sporadic</strong>: respondent voted in at least two, but fewer than all-but-one of the elections they were eligible in</li>
<li><strong>rarely/never</strong>: respondent voted in 0 or 1 of the elections they were eligible in</li>
</ul></li>
</ul>
<p>You can read in the data directly from the GitHub repo:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>voter_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/fivethirtyeight/data/master/non-voters/nonvoters_data.csv&quot;</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="lab" class="level1">
<h1>Lab</h1>
<ul>
<li>The variable <code>Q30</code> contains the respondent’s political party identification. Make a new variable that simplifies <code>Q30</code> into four categories: “Democrat”, “Republican”, “Independent”, “Other” (“Other” also includes respondents who did not answer the question).</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>voter_data <span class="ot">&lt;-</span> voter_data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pol_ident_new =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;Rep&quot;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;Dem&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;Indep&quot;</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
</details>
</div>
<ul>
<li>The variable <code>voter_category</code> identifies the respondent’s past voter behavior. Relevel the variable to make rarely/never the baseline level, followed by sporadic, then always</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter your code</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuring out what unique variables are available</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;always&quot;       &quot;rarely/never&quot; &quot;sporadic&quot;    </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordering</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>voter_data<span class="sc">$</span>voter_category <span class="ot">=</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category), <span class="at">ref =</span> <span class="st">&quot;sporadic&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recheck level order</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;sporadic&quot;     &quot;always&quot;       &quot;rarely/never&quot;</code></pre>
</div>
</div>
<ul>
<li>Center the age variable to make the intercept more interepretable. That is, so that it reflects the log-odds for an average-aged person rather than a 0-year old person</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># enter code </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>voter_data<span class="ot">=</span>voter_data <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ppage_centered =</span> ppage <span class="sc">-</span> <span class="fu">mean</span>(ppage))</span></code></pre></div>
</details>
</div>
<ul>
<li>In the <a href="https://projects.fivethirtyeight.com/non-voters-poll-2020-election/">FiveThirtyEight article</a>, the authors include visualizations of the relationship between the voter category and demographic variables such as race, age, education, etc. Select two demographic variables. For each variable, try to replicate the visualizations and interpret the plot to describe its relationship with voter category. Have fun with it: https://www.mikelee.co/posts/2020-02-08-recreate-fivethirtyeight-chicklet-stacked-bar-chart-in-ggplot2.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">=</span><span class="fu">ggplot</span>(voter_data, <span class="fu">aes</span>(<span class="at">x =</span> voter_category, <span class="at">y =</span> ppage)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;Blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot; Voter Category vs. PPage&quot;</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Voter Category&quot;</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">=</span><span class="fu">ggplot</span>(voter_data, <span class="fu">aes</span>(<span class="at">x =</span> voter_category, <span class="at">fill =</span> income_cat)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Voter Category vs. Income Category Counts&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Voter Category&quot;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>The plots can be combined into a single plot using the patchwork package.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="Lab4_multinom_Questions-1_files/figure-html/unnamed-chunk-8-1.png" class="margin-caption img-fluid" width="768" /></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Fit a model using mean-centered age, race, gender, income, and education to predict voter category. Show the code used to fit the model, but do <strong>not</strong> display the model output.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">library</span>(nnet)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Enter code</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(voter_category <span class="sc">~</span> ppage_centered<span class="sc">+</span>race<span class="sc">+</span>gender<span class="sc">+</span>income_cat<span class="sc">+</span>educ , <span class="at">data =</span> voter_data) </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  36 (22 variable)
initial  value 6411.501317 
iter  10 value 5787.319553
iter  20 value 5710.106757
final  value 5693.312867 
converged</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = voter_category ~ ppage_centered + race + gender + 
    income_cat + educ, data = voter_data)

Coefficients:
             (Intercept) ppage_centered raceHispanic raceOther/Mixed raceWhite
always        -0.2930636     0.01302944  -0.41064914      -0.3098896 0.1666330
rarely/never  -1.5717468    -0.04756711   0.00653516       0.3728727 0.1274334
              genderMale income_cat$40-75k income_cat$75-125k
always       -0.11444321        0.06029828       0.1474791658
rarely/never  0.09612722        0.12720614       0.0008327606
             income_catLess than $40k educHigh school or less educSome college
always                    -0.09375046              -0.4307847      -0.05493845
rarely/never               0.66256504               0.9221824       0.35703209

Std. Errors:
             (Intercept) ppage_centered raceHispanic raceOther/Mixed  raceWhite
always         0.1064595    0.001954865    0.1212049       0.1546103 0.08711378
rarely/never   0.1313277    0.002287714    0.1256846       0.1567324 0.10173736
             genderMale income_cat$40-75k income_cat$75-125k
always       0.06270386        0.09207983          0.0842924
rarely/never 0.07068793        0.11021246          0.1059299
             income_catLess than $40k educHigh school or less educSome college
always                      0.1027393              0.08639085       0.07673907
rarely/never                0.1121243              0.09566403       0.09377194

Residual Deviance: 11386.63 
AIC: 11430.63 </code></pre>
</div>
</div>
<ul>
<li><em>Should party identification be added to the model?</em></li>
<li>#Hint: Use an anova test to make the determination</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter code</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    model2 <span class="ot">&lt;-</span> <span class="fu">multinom</span>(voter_category <span class="sc">~</span> ppage_centered<span class="sc">+</span>race<span class="sc">+</span>gender<span class="sc">+</span>income_cat<span class="sc">+</span>educ<span class="sc">+</span>pol_ident_new , <span class="at">data =</span> voter_data) </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  45 (28 variable)
initial  value 6411.501317 
iter  10 value 5712.138215
iter  20 value 5630.480535
iter  30 value 5617.781229
final  value 5616.390878 
converged</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = voter_category ~ ppage_centered + race + gender + 
    income_cat + educ + pol_ident_new, data = voter_data)

Coefficients:
             (Intercept) ppage_centered raceHispanic raceOther/Mixed  raceWhite
always        -0.2411758     0.01252151  -0.38124890      -0.2680365 0.20474650
rarely/never  -1.7315773    -0.04568583  -0.04024104       0.3324263 0.07753584
              genderMale income_cat$40-75k income_cat$75-125k
always       -0.10212938        0.07337959         0.15268950
rarely/never  0.09005921        0.07376215        -0.01249317
             income_catLess than $40k educHigh school or less educSome college
always                    -0.07629406              -0.4139089      -0.03742667
rarely/never               0.58781862               0.8532964       0.29289159
             pol_ident_newIndep pol_ident_newOther pol_ident_newRep
always               -0.1698740         -0.4605512      -0.07796573
rarely/never          0.3924389          0.9404568       0.08381229

Std. Errors:
             (Intercept) ppage_centered raceHispanic raceOther/Mixed  raceWhite
always         0.1078881    0.001964019    0.1222822       0.1560996 0.09266425
rarely/never   0.1360832    0.002324481    0.1280062       0.1590606 0.10784955
             genderMale income_cat$40-75k income_cat$75-125k
always       0.06322716        0.09227759         0.08441574
rarely/never 0.07217159        0.11136556         0.10662568
             income_catLess than $40k educHigh school or less educSome college
always                      0.1030657              0.08698980       0.07734979
rarely/never                0.1137400              0.09739894       0.09520346
             pol_ident_newIndep pol_ident_newOther pol_ident_newRep
always               0.08404605          0.1211546       0.08191505
rarely/never         0.09769631          0.1062289       0.10276761

Residual Deviance: 11232.78 
AIC: 11288.78 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model,model2)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                               Model Resid. df
1                 ppage_centered + race + gender + income_cat + educ     11650
2 ppage_centered + race + gender + income_cat + educ + pol_ident_new     11644
  Resid. Dev   Test    Df LR stat. Pr(Chi)
1   11386.63           NA       NA      NA
2   11232.78 1 vs 2     6  153.844       0</code></pre>
</div>
</div>
<pre><code>&gt; #Enter answer based on your code: Yes! There is significant gain in variance explained</code></pre>
<p><strong>Use the model you select for the remainder of the assignment</strong>.</p>
<section id="lrt" class="level2">
<h2>LRT</h2>
<ul>
<li><p>Run the full model and report overall significance of each of the terms</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(model2)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: voter_category
               LR Chisq Df Pr(&gt;Chisq)    
ppage_centered   638.30  2  &lt; 2.2e-16 ***
race              52.65  6  1.379e-09 ***
gender             6.03  2     0.0491 *  
income_cat        67.72  6  1.198e-12 ***
educ             154.14  4  &lt; 2.2e-16 ***
pol_ident_new    153.84  6  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div></li>
</ul>
</section>
<section id="marginal-effects-political-group---emmeans" class="level2">
<h2>Marginal Effects Political Group - Emmeans</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get estimated marginal means from the model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#using </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>multinomial_analysis_age <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> pol_ident_new<span class="sc">|</span>voter_category)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multinomial_analysis_age, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;pol_ident_new&quot;</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># you can add a parameter to the above command, ref = newbaseline, if you want to change baseline</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 18%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">pol_ident_new</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">-0.482</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.478</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">-0.961</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-13.722</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Indep</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.954</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Indep</td>
<td style="text-align: right;">-0.591</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-7.643</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">-0.913</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.263</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">-0.078</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-0.902</td>
<td style="text-align: right;">0.747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-7.885</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">-0.883</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-10.469</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="marginal-effects-of-education---emmeans" class="level2">
<h2>Marginal Effects of Education - Emmeans</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter code</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>multinomial_analysis_educ <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> educ<span class="sc">|</span>voter_category)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multinomial_analysis_educ, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;educ&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># you can add a parameter to the above command, ref = newbaseline, if you want to change baseline</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table style="width:100%;">
<colgroup>
<col style="width: 32%" />
<col style="width: 25%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 3%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">educ</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">College</td>
<td style="text-align: right;">-0.509</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.497</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">College</td>
<td style="text-align: right;">-0.986</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-12.904</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">High school or less</td>
<td style="text-align: right;">-0.898</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-12.189</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">High school or less</td>
<td style="text-align: right;">-0.187</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-2.705</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Some college</td>
<td style="text-align: right;">-0.540</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.357</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Some college</td>
<td style="text-align: right;">-0.707</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-9.512</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><p>Next, plot the predicted probabilities of voter category as a function of Age and Party ID</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggemmeans</span>(model2, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;ppage_centered&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted , <span class="at">fill =</span> response.level)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>() <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">&quot;b&quot;</span>, <span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Predicted Probablity</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Predicted Probabilities of Voting Frequency by Age&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;always&quot;</span> <span class="ot">=</span> <span class="st">&quot;#F6B533&quot;</span>, <span class="st">&quot;sporadic&quot;</span> <span class="ot">=</span> <span class="st">&quot;#D07EA2&quot;</span>, <span class="st">&quot;rarely/never&quot;</span> <span class="ot">=</span> <span class="st">&quot;#9854F7&quot;</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;RARELY OR NEVER VOTE    &quot;</span>, <span class="st">&quot;SOMETIMES VOTE    &quot;</span>, <span class="st">&quot;ALMOST ALWAYS VOTE    &quot;</span>),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;rarely/never&quot;</span>, <span class="st">&quot;sporadic&quot;</span>, <span class="st">&quot;always&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="Lab4_multinom_Questions-1_files/figure-html/unnamed-chunk-14-1.png" class="margin-caption img-fluid" width="768" /></p>
</figure>
</div>
</div>
</div></li>
</ul>
<p>Plot predicted probabilities as a function of education and voting frequency.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggemmeans</span>(model2, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;pol_ident_new&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">fill =</span> response.level))<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span> ) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(predicted, <span class="dv">3</span>)), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;polID&quot;</span>, <span class="st">&quot;Predicted Probablity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="Lab4_multinom_Questions-1_files/figure-html/unnamed-chunk-15-1.png" class="margin-caption img-fluid" width="768" /></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggemmeans</span>(model2, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;educ&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">fill =</span> response.level))<span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span> ) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(predicted, <span class="dv">3</span>)), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Education&quot;</span>, <span class="st">&quot;Predicted Probablity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="Lab4_multinom_Questions-1_files/figure-html/unnamed-chunk-16-1.png" class="margin-caption img-fluid" width="768" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="write-up" class="level2">
<h2>Write-up</h2>
<section id="differences-between-political-groups-and-voting-behavior---emmeans" class="level3">
<h3>Differences between political groups and voting behavior - Emmeans</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>multi_an <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> pol_ident_new<span class="sc">|</span>voter_category)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multi_an, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;pol_ident_new&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 18%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">pol_ident_new</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">-0.482</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.478</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">-0.961</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-13.722</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Indep</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.954</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Indep</td>
<td style="text-align: right;">-0.591</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-7.643</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">-0.913</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.263</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">-0.078</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-0.902</td>
<td style="text-align: right;">0.747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-7.885</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">-0.883</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-10.469</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference between yes-no and fair-excellent</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(coefs, <span class="st">&quot;revpairwise&quot;</span>, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 35%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast1</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Indep - Dem</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.159</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-1.918</td>
<td style="text-align: right;">0.244</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other - Dem</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.432</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-3.598</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other - Indep</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.273</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-2.171</td>
<td style="text-align: right;">0.156</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rep - Dem</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.075</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-0.927</td>
<td style="text-align: right;">0.791</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rep - Indep</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">0.757</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rep - Other</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">0.357</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">2.905</td>
<td style="text-align: right;">0.034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Indep - Dem</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">3.933</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other - Dem</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.883</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">8.578</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other - Indep</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">4.807</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rep - Dem</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.787</td>
<td style="text-align: right;">0.860</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rep - Indep</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">-0.292</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-2.965</td>
<td style="text-align: right;">0.029</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rep - Other</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">-0.805</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-7.404</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="differences-between-education-level-and-voting-behavior---emmeans" class="level3">
<h3>Differences between education level and voting behavior - Emmeans</h3>
<p>Last part of the assignment: Interpret the results from running the following code for your model</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>multi_an <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> educ<span class="sc">|</span>voter_category)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multi_an, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;educ&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table style="width:100%;">
<colgroup>
<col style="width: 32%" />
<col style="width: 25%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 3%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">educ</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">College</td>
<td style="text-align: right;">-0.509</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.497</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">College</td>
<td style="text-align: right;">-0.986</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-12.904</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">High school or less</td>
<td style="text-align: right;">-0.898</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-12.189</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">High school or less</td>
<td style="text-align: right;">-0.187</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-2.705</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: left;">Some college</td>
<td style="text-align: right;">-0.540</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-8.357</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: left;">Some college</td>
<td style="text-align: right;">-0.707</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-9.512</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference between yes-no and fair-excellent</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(coefs, <span class="st">&quot;revpairwise&quot;</span>, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display margin-caption">
<table>
<colgroup>
<col style="width: 36%" />
<col style="width: 27%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast1</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">High school or less - College</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-4.492</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some college - College</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">-0.031</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-0.412</td>
<td style="text-align: right;">0.911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Some college - High school or less</td>
<td style="text-align: left;">always - sporadic</td>
<td style="text-align: right;">0.358</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">4.220</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">High school or less - College</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">8.416</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Some college - College</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">3.030</td>
<td style="text-align: right;">0.014</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some college - High school or less</td>
<td style="text-align: left;">(rarely/never) - sporadic</td>
<td style="text-align: right;">-0.520</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">-5.920</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Enter your interpretation here: People with higher education show a stronger contrast between “sporadic voters” vs. “always” or “rarely/never” voters. As education level goes up, the more frequently people vote. However, people with college education are less likely to vote frequently, as compared to sporadically.</p>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">quartoblog</span> <span class="hidden" data-render-id="quarto-int-navbar-title">quartoblog</span> <span class="hidden" data-render-id="quarto-int-navbar:About">About</span> <span class="hidden" data-render-id="quarto-int-navbar:/about.html">/about.html</span> <span class="hidden" data-render-id="quarto-int-navbar:https://github.com/">https://github.com/</span> <span class="hidden" data-render-id="quarto-int-navbar:https://twitter.com">https://twitter.com</span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">quartoblog - Lab 4 - Multinomial Regression - Questions</span> <span class="hidden" data-render-id="quarto-twittercardtitle">quartoblog - Lab 4 - Multinomial Regression - Questions</span> <span class="hidden" data-render-id="quarto-ogcardtitle">quartoblog - Lab 4 - Multinomial Regression - Questions</span> <span class="hidden" data-render-id="quarto-metasitename">quartoblog</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
<!-- -->
<div class="quarto-embedded-source-code">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">    title: &quot;Lab 4 - Multinomial Regression - Questions&quot;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">    image: bike.png</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">    author:</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: Suyog Chandramouli</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">    date: last-modified</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">    format:</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">      html:</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">        self-contained: true</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">        anchor-sections: true</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">        code-fold: true</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">        fig-width: 8</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">        fig-height: 4</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">        code-block-bg: &quot;#f1f3f5&quot;</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">        code-block-border-left: &quot;#31BAE9&quot;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">        mainfont: Source Sans Pro</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">        theme: journal</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">        toc: true</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">        toc-depth: 3</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">        toc-location: left</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co">        captions: true</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">        cap-location: margin</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">        table-captions: true</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">        tbl-cap-location: margin</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">        reference-location: margin</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">      pdf:</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">        pdf-engine: lualatex</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co">        toc: false</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">        number-sections: true</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co">        number-depth: 2</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co">        top-level-division: section</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co">        reference-location: document</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="co">        listings: false</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="co">        header-includes:</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="co">          \usepackage{marginnote, here, relsize, needspace, setspace}</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co">          \def\it{\emph}</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="co">    comments:</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">      hypothesis: false</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co">    execute:</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="co">      warning: false</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="co">      message: false</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>Lab Goal: Predict voting frequency using demographic variables Data source: FiveThirtyEight &quot;Why Many Americans Don&#39;t Vote&quot; survey Method: Multinomial logistic regression</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>The data for this assignment comes from an online Ipsos survey that was conducted for the FiveThirtyEight article <span class="co">[</span><span class="ot">&quot;Why Many Americans Don&#39;t Vote&quot;</span><span class="co">](https://projects.fivethirtyeight.com/non-voters-poll-2020-election/)</span>. You can read more about the survey design and respondents in the README of the <span class="co">[</span><span class="ot">GitHub repo</span><span class="co">](https://github.com/fivethirtyeight/data/tree/master/non-voters)</span> for the data.</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>Respondents were asked a variety of questions about their political beliefs, thoughts on multiple issues, and voting behavior. We will focus on using the demographic variables and someone&#39;s party identification to understand whether a person is a probable voter.</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>The variables we&#39;ll focus on were (definitions from the codebook in data set GitHub repo):</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ppage`</span>: Age of respondent</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`educ`</span>: Highest educational attainment category.\</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`race`</span>: Race of respondent, census categories. Note: all categories except Hispanic were non-Hispanic.</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gender`</span>: Gender of respondent</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`income_cat`</span>: Household income category of respondent</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Q30`</span>: Response to the question &quot;Generally speaking, do you think of yourself as a...&quot;</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>1: Republican</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>2: Democrat</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>3: Independent</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>4: Another party, please specify</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>5: No preference</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>-1: No response</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`voter_category`</span>: past voting behavior:</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**always**: respondent voted in all or all-but-one of the elections they were eligible in</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**sporadic**: respondent voted in at least two, but fewer than all-but-one of the elections they were eligible in</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**rarely/never**: respondent voted in 0 or 1 of the elections they were eligible in</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>You can read in the data directly from the GitHub repo:</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>voter_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/fivethirtyeight/data/master/non-voters/nonvoters_data.csv&quot;</span>)</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a><span class="fu"># Lab</span></span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The variable <span class="in">`Q30`</span> contains the respondent&#39;s political party identification. Make a new variable that simplifies <span class="in">`Q30`</span> into four categories: &quot;Democrat&quot;, &quot;Republican&quot;, &quot;Independent&quot;, &quot;Other&quot; (&quot;Other&quot; also includes respondents who did not answer the question).</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>voter_data <span class="ot">&lt;-</span> voter_data <span class="sc">%&gt;%</span></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pol_ident_new =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;Rep&quot;</span>, </span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;Dem&quot;</span>, </span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>    Q30<span class="sc">==</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;Indep&quot;</span>, </span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The variable <span class="in">`voter_category`</span> identifies the respondent&#39;s past voter behavior. Relevel the variable to make rarely/never the baseline level, followed by sporadic, then always</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter your code</span></span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuring out what unique variables are available</span></span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category))</span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordering</span></span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a>voter_data<span class="sc">$</span>voter_category <span class="ot">=</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category), <span class="at">ref =</span> <span class="st">&quot;sporadic&quot;</span>)</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Recheck level order</span></span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(voter_data<span class="sc">$</span>voter_category))</span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Center the age variable to make the intercept more interepretable. That is, so that it reflects the log-odds for an average-aged person rather than a 0-year old person</span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a><span class="co"># enter code </span></span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a>voter_data<span class="ot">=</span>voter_data <span class="sc">%&gt;%</span></span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ppage_centered =</span> ppage <span class="sc">-</span> <span class="fu">mean</span>(ppage))</span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the <span class="co">[</span><span class="ot">FiveThirtyEight article</span><span class="co">](https://projects.fivethirtyeight.com/non-voters-poll-2020-election/)</span>, the authors include visualizations of the relationship between the voter category and demographic variables such as race, age, education, etc. Select two demographic variables. For each variable, try to replicate the visualizations and interpret the plot to describe its relationship with voter category. Have fun with it: https://www.mikelee.co/posts/2020-02-08-recreate-fivethirtyeight-chicklet-stacked-bar-chart-in-ggplot2.</span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">=</span><span class="fu">ggplot</span>(voter_data, <span class="fu">aes</span>(<span class="at">x =</span> voter_category, <span class="at">y =</span> ppage)) <span class="sc">+</span></span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;Blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot; Voter Category vs. PPage&quot;</span>,</span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Voter Category&quot;</span>,</span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Age&quot;</span>)</span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">=</span><span class="fu">ggplot</span>(voter_data, <span class="fu">aes</span>(<span class="at">x =</span> voter_category, <span class="at">fill =</span> income_cat)) <span class="sc">+</span></span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Voter Category vs. Income Category Counts&quot;</span>,</span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Voter Category&quot;</span>,</span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a>The plots can be combined into a single plot using the patchwork package.</span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter code</span></span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fit a model using mean-centered age, race, gender, income, and education to predict voter category. Show the code used to fit the model, but do **not** display the model output.</span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-203"><a href="#cb34-203" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-204"><a href="#cb34-204" aria-hidden="true" tabindex="-1"></a>   <span class="fu">library</span>(nnet)</span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Enter code</span></span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(voter_category <span class="sc">~</span> ppage_centered<span class="sc">+</span>race<span class="sc">+</span>gender<span class="sc">+</span>income_cat<span class="sc">+</span>educ , <span class="at">data =</span> voter_data) </span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model)</span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Should party identification be added to the model?*</span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>#Hint: Use an anova test to make the determination</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter code</span></span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>    model2 <span class="ot">&lt;-</span> <span class="fu">multinom</span>(voter_category <span class="sc">~</span> ppage_centered<span class="sc">+</span>race<span class="sc">+</span>gender<span class="sc">+</span>income_cat<span class="sc">+</span>educ<span class="sc">+</span>pol_ident_new , <span class="at">data =</span> voter_data) </span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model,model2)</span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a><span class="in">&gt; #Enter answer based on your code: Yes! There is significant gain in variance explained</span></span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>**Use the model you select for the remainder of the assignment**.</span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## LRT</span></span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Run the full model and report overall significance of each of the terms</span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a>    <span class="in">```{r}</span></span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a><span class="in">    Anova(model2)</span></span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## Marginal Effects Political Group - Emmeans</span></span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a><span class="co">#Get estimated marginal means from the model</span></span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a><span class="co">#using </span></span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>multinomial_analysis_age <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> pol_ident_new<span class="sc">|</span>voter_category)</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multinomial_analysis_age, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;pol_ident_new&quot;</span>)</span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a><span class="co"># you can add a parameter to the above command, ref = newbaseline, if you want to change baseline</span></span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Marginal Effects of Education - Emmeans</span></span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a><span class="co">#Enter code</span></span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>multinomial_analysis_educ <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> educ<span class="sc">|</span>voter_category)</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multinomial_analysis_educ, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;educ&quot;</span>)</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a><span class="co"># you can add a parameter to the above command, ref = newbaseline, if you want to change baseline</span></span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Next, plot the predicted probabilities of voter category as a function of Age and Party ID</span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a>    <span class="in">```{r}</span></span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a><span class="in">      ggemmeans(model2, terms = c(&quot;ppage_centered&quot;)) %&gt;% </span></span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a><span class="in">      ggplot(., aes(x = x, y = predicted , fill = response.level)) +</span></span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a><span class="in">      geom_area() + </span></span>
<span id="cb34-280"><a href="#cb34-280" aria-hidden="true" tabindex="-1"></a><span class="in">      geom_rug(sides = &quot;b&quot;, position = &quot;jitter&quot;, alpha = .5) + </span></span>
<span id="cb34-281"><a href="#cb34-281" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = &quot;\nAge&quot;, y = &quot;Predicted Probablity\n&quot;, title = &quot;Predicted Probabilities of Voting Frequency by Age&quot;) +</span></span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_manual(</span></span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a><span class="in">        name = NULL,</span></span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a><span class="in">        values = c(&quot;always&quot; = &quot;#F6B533&quot;, &quot;sporadic&quot; = &quot;#D07EA2&quot;, &quot;rarely/never&quot; = &quot;#9854F7&quot;),</span></span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a><span class="in">        labels = c(&quot;RARELY OR NEVER VOTE    &quot;, &quot;SOMETIMES VOTE    &quot;, &quot;ALMOST ALWAYS VOTE    &quot;),</span></span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a><span class="in">        breaks = c(&quot;rarely/never&quot;, &quot;sporadic&quot;, &quot;always&quot;)</span></span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a><span class="in">      ) +</span></span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a><span class="in">      theme_minimal()</span></span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>Plot predicted probabilities as a function of education and voting frequency.</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a><span class="fu">ggemmeans</span>(model2, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;pol_ident_new&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">fill =</span> response.level))<span class="sc">+</span></span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span> ) <span class="sc">+</span> </span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(predicted, <span class="dv">3</span>)), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;polID&quot;</span>, <span class="st">&quot;Predicted Probablity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a><span class="fu">ggemmeans</span>(model2, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;educ&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-309"><a href="#cb34-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">fill =</span> response.level))<span class="sc">+</span></span>
<span id="cb34-310"><a href="#cb34-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span> ) <span class="sc">+</span> </span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(predicted, <span class="dv">3</span>)), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),<span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb34-312"><a href="#cb34-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Education&quot;</span>, <span class="st">&quot;Predicted Probablity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-313"><a href="#cb34-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a><span class="fu">## Write-up</span></span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a><span class="fu">### Differences between political groups and voting behavior - Emmeans</span></span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a>multi_an <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> pol_ident_new<span class="sc">|</span>voter_category)</span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multi_an, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;pol_ident_new&quot;</span>)</span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference between yes-no and fair-excellent</span></span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(coefs, <span class="st">&quot;revpairwise&quot;</span>, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-332"><a href="#cb34-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-333"><a href="#cb34-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Differences between education level and voting behavior - Emmeans</span></span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a>Last part of the assignment: Interpret the results from running the following code for your model</span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-341"><a href="#cb34-341" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb34-342"><a href="#cb34-342" aria-hidden="true" tabindex="-1"></a>multi_an <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> educ<span class="sc">|</span>voter_category)</span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(multi_an, <span class="st">&quot;log&quot;</span>),<span class="st">&quot;trt.vs.ctrl1&quot;</span>,  <span class="at">by=</span><span class="st">&quot;educ&quot;</span>)</span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(coefs, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference between yes-no and fair-excellent</span></span>
<span id="cb34-350"><a href="#cb34-350" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(coefs, <span class="st">&quot;revpairwise&quot;</span>, <span class="at">by =</span> <span class="st">&quot;contrast&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-351"><a href="#cb34-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a>Enter your interpretation here: People with higher education show a stronger contrast between &quot;sporadic voters&quot; vs. &quot;always&quot; or &quot;rarely/never&quot; voters. As education level goes up, the more frequently people vote. However, people with college education are less likely to vote frequently, as compared to sporadically.</span></code></pre></div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->

</body>

</html>
